<div class="max-w-[900px] mx-auto font-sans">
    <!-- Header -->
    <div class="bg-green-600 p-2 text-white text-center">
        IT 06-1
    </div>

    <!-- Input Row -->
    <div class="my-5 flex gap-3 items-start">
        <label for="productCode">รหัสสินค้า</label>
        <div class="flex-1">
            <input id="productCode" type="text" [(ngModel)]="newCode" (input)="formatInput($event)"
                placeholder="xxxx-xxxx-xxxx-xxxx"
                [class]="'w-full p-2 border rounded placeholder:text-gray-400 placeholder:font-light ' + (isDuplicate ? 'border-red-500' : '')"
                maxlength="19" />
            @if (isDuplicate) {
            <p class="text-red-500 text-sm mt-1">{{ errorMessage }}</p>
            }
        </div>
        <button (click)="addProduct()" class="bg-blue-600 text-white border-none px-4 py-2 rounded hover:bg-blue-700">
            ADD
        </button>
    </div>

    <!-- Table -->
    <table class="w-full border-collapse border border-gray-300">
        <thead>
            <tr class="bg-sky-500 text-black">
                <th class="border border-gray-300 p-2">Id</th>
                <th class="border border-gray-300 p-2">รหัสสินค้า (16 หลัก)</th>
                <th class="border border-gray-300 p-2">บาร์โค้ดสินค้า</th>
                <th class="border border-gray-300 p-2">Action</th>
            </tr>
        </thead>
        <tbody>
            @for (p of products; track p.id) {
            <tr class="text-center text-black">
                <td class="border border-gray-300 p-2">{{ p.id }}</td>
                <td class="border border-gray-300 p-2">{{ p.code }}</td>
                <td class="border border-gray-300 p-2">
                    <img [src]="'data:image/png;base64,' + p.barcode" alt="Barcode" class="mx-auto">
                </td>
                <td class="border border-gray-300 p-2">
                    <button (click)="openModal(p)" class="bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700">
                        ลบ
                    </button>
                </td>
            </tr>
            }
        </tbody>
    </table>

    <!-- Modal -->
    @if (showModal) {
    <div class="fixed inset-0 bg-black/40 flex items-center justify-center z-50">
        <div class="bg-white p-6 rounded shadow-lg border border-gray-400 w-[400px] text-center">
            <p class="mb-4 text-black-600">{{ modalMessage }}</p>
            <div class="flex justify-center gap-4">
                <button (click)="confirmDelete()" class="px-5 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                    ตกลง
                </button>
                <button (click)="closeModal()" class="px-5 py-2 bg-red-600 text-white rounded hover:bg-red-700">
                    ยกเลิก
                </button>
            </div>
        </div>
    </div>
    }
</div>